#!/usr/bin/env python
import os
import subprocess
import commands

from sys import argv
year = argv[1:2]

#for runnum in [300079,300087,300105,300106,300107,300117,300122,300123,300124,300155,300156,300157,300226,300233,300234,300235,300236,300237,300238,300239,300240,300280,300281,300282,300283,300284,300364,300365,300366,300367,300368,300369,300370,300371,300372,300373,300374,300375,300389,300390,300391,300392,300393,300394,300395,300396,300397,300398,300399,300400,300401,300459,300461,300462,300463,300464,300466,300467,300497,300498,300499,300500,300514,300515,300516,300517,300538,300539,300545,300548,300551,300552,300558,300560,300574,300575,300576,300631,300632,300633,300635,300636,300673,300674,300675,300676,300742,300777,300780,300785,300806,300811,300812,300816,300817,301046,301086,301141,301142,301161,301165,301179,301180,301183,301281,301283,301298,301323,301330,301359,301383,301384,301391,301392,301393,301394,301395,301396,301397,301398,301399,301417,301447,301448,301449,301450,301461,301472,301473,301474,301475,301476,301480,301519,301521,301524,301525,301526,301528,301529,301530,301531,301532,301567,301627,301664,301665,301694,301912,301913,301914,301941,301959,301960,301969,301970,301984,301985,301986,301987,301997,301998,302019,302026,302027,302029,302030,302031,302032,302033,302034,302036,302037,302038,302040,302041,302042,302043,302131,302159,302163,302165,302166,302225,302228,302229,302239,302240,302262,302263,302277,302279,302280,302322,302328,302337,302342,302343,302344,302349,302350,302388,302392,302393,302448,302472,302473,302474,302475,302476,302479,302484,302485,302486,302487,302490,302491,302492,302493,302494,302509,302513,302522,302523,302524,302525,302526,302548,302549,302550,302551,302552,302553,302554,302555,302563,302564,302565,302566,302567,302569,302570,302571,302572,302573,302596,302597,302634,302635,302646,302649,302650,302651,302654,302660,302661,302662,302663,303824,303825,303832,303838,303885,303948,303989,303998,303999,304000,304062,304119,304120,304125,304144,304158,304169,304170,304196,304197,304198,304199,304200,304204,304209,304291,304292,304333,304354,304366,304446,304447,304448,304449,304451,304505,304506,304507,304508,304562,304616,304625,304626,304654,304655,304661,304662,304663,304671,304672,304737,304738,304739,304740,304776,304777,304778,304797,305040,305043,305044,305045,305046,305059,305060,305061,305062,305063,305064,305081,305112,305113,305114,305178,305179,305181,305182,305183,305184,305185,305186,305188,305202,305204,305207,305208,305234,305235,305236,305237,305247,305248,305249,305250,305252,305282,305310,305311,305312,305313,305314,305336,305338,305341,305349,305350,305351,305358,305364,305365,305366,305376,305377,305405,305406,305440,305441,305516,305517,305518,305586,305588,305589,305590,305636,305766,305809,305814,305821,305832,305840,305841,305842,305862,305898,305902,305965,305966,305967,306029,306030,306036,306037,306038,306040,306041,306042,306048,306049,306051,306091,306092,306093,306094,306095,306121,306122,306125,306126]:
#for runnum in [306134,306135,306137,306138,306139,306153,306154,306155,306169,306170,306171,306417,306418,306419,306420,306422,306423,306425,306432,306454,306455,306456,306457,306458,306459,306460]:

sizeChunk=50
lumiChunk=10
dirDQM="/afs/cern.ch/user/d/dwalter/cernBox/www/ZCounting/DQM-Offline-2018/"
dirMC="/afs/cern.ch/work/x/xniu/public/CMSSW_9_2_8/src/ZCountHarvest/LookupTable/"
dirMCShape="MCFiles/92X_norw_IsoMu27_noIso/"
dirCSV="/eos/home-d/dwalter/www/ZCounting/CMS-2018-ZRateData/csvFiles/"
dirEff="/eos/home-d/dwalter/www/ZCounting/CMS-2018-ZRateData/ZAndMuonEfficiencies/RunsAndFits/"


if year == ['2016']:
    dirDQM="/afs/cern.ch/user/d/dwalter/cernBox/www/ZCounting/DQM-Offline-2016/"
    ByLsCSV=""
    runlist= (0,0)
elif year == ['2018']:
    dirDQM="/afs/cern.ch/user/d/dwalter/cernBox/www/ZCounting/DQM-Offline-2018/"
    ByLsCSV="/eos/cms/store/group/comm_luminosity/ZCounting/brilcalcFile2018/briloutByLS_11_19_18.csv"
    runlist = (315257,315259,315264,315265,315267,315270,315322,315339,315357,315361,315363,315366,315420,315488,315489,315490,315506,315510,315512,315543,315555,315556,315557,315640,315641,315642,315644,315645,315646,315647,315648,315689,315690,315702,315703,315704,315705,315713,315721,315741,315764,315770,315784,315785,315786,315790,315800,315801,315840,315973,315974,316058,316059,316060,316061,316062,316082,316110,316111,316113,316114,316153,316186,316187,316199,316200,316201,316202,316216,316217,316218,316219,316239,316240,316241,316271,316361,316362,316363,316377,316378,316379,316380,316455,316457,316469,316470,316472,316505,316569,316590,316613,316615,316666,316667,316700,316701,316702,316715,316716,316717,316718,316719,316720,316721,316722,316723,316758,316766,316876,316877,316879,316928,316985,316993,316994,316995)
else:
     print "no data for year "+str(year)

#runlist = (315259,315264)

cs_file = open("cs_tmp.sub", "w")

cs_file.write("executable  = runZCountingOnBatch.sh \n")
cs_file.write("output      = condor/output/$(ClusterId).$(ProcId).out \n")
cs_file.write("error       = condor/error/$(ClusterId).$(ProcId).err \n")
cs_file.write("log         = condor/log/$(ClusterId).$(ProcId).log \n")
cs_file.write("+JobFlavour =\"longlunch\" \n")
for run in runlist:
    cs_file.write("arguments  = {0} {1} {2} {3} {4} {5} {6} {7} {8}\n".format(str(run), str(lumiChunk),
        str(sizeChunk),
        dirDQM,
        ByLsCSV,
        dirMC,
        dirMCShape,
        dirCSV,
        dirEff
	))

    cs_file.write("queue\n")
cs_file.close()

os.system("condor_submit cs_tmp.sub")

#os.system("rm cs_tmp.sub")
