#!/usr/bin/env python
import os
import subprocess
import commands

from sys import argv
year = argv[1:2]

dirDQM="/afs/cern.ch/user/d/dwalter/cernBox/www/ZCounting/development/DQM-Offline-2018-V2/"
dirMC="/afs/cern.ch/work/x/xniu/public/CMSSW_9_2_8/src/ZCountHarvest/LookupTable/"
dirMCShape="MCFiles/92X_norw_IsoMu27_noIso/"
#dirCSV="/eos/home-d/dwalter/www/ZCounting/CMS-2018-ZRateData/csvFiles/"
#dirEff="/eos/home-d/dwalter/www/ZCounting/CMS-2018-ZRateData/ZAndMuonEfficiencies/RunsAndFits/"
dirCSV="/eos/home-d/dwalter/www/ZCounting/development/CMS-2018-ZRateData/csvFiles/"
dirEff="/eos/home-d/dwalter/www/ZCounting/development/CMS-2018-ZRateData/ZAndMuonEfficiencies/RunsAndFits/"

if year == ['2016']:
    dirDQM="/afs/cern.ch/user/d/dwalter/cernBox/www/ZCounting/DQM-Offline-2016/"
    ByLsCSV="/afs/cern.ch/work/d/dwalter/CMSSW_9_2_8/src/ZCounting/Stuff/ByLs_2016_IsoMu24OrIsoTkMu24_pcc16PaperV2.csv"
    runlist=(273158,273302,273402,273403,273404,273405,273406,273408,273409,273410,273411,273425,273446,273447,273448,273449,273450,273492,273493,273494,273502,273503,273554,273555,273725,273728,273730,274094,274146,274157,274159,274160,274161,274172,274198,274199,274200,274240,274241,274244,274250,274251,274283,274284,274286,274314,274315,274316,274317,274319,274335,274336,274337,274338,274339,274344,274345,274382,274387,274388,274420,274421,274422,274440,274441,274442,274954,274955,274968,274969,274970,274971,274998,274999,275000,275001,275059,275066,275067,275068,275073,275074,275124,275125,275282,275283,275284,275290,275291,275292,275293,275309,275310,275311,275319,275337,275338,275344,275345,275370,275371,275375,275376,275657,275658,275659,275761,275767,275772,275773,275774,275776,275777,275778,275782,275832,275833,275834,275835,275836,275837,275847,275886,275890,275911,275912,275913,275918,275920,275921,275923,275931,275963,276092,276097,276242,276243,276244,276282,276283,276315,276317,276318,276355,276361,276363,276384,276437,276454,276458,276495,276501,276502,276525,276527,276528,276542,276543,276544,276545,276581,276582,276583,276584,276585,276586,276587,276653,276655,276659,276775,276776,276794,276807,276808,276810,276811,276831,276834,276870,276935,276940,276946,276947,276948,276950,277069,277070,277071,277072,277073,277076,277087,277094,277096,277112,277126,277127,277148,277166,277168,277180,277194,277305,277420,277981,277991,277992,278017,278018,278167,278175,278193,278239,278240,278273,278274,278288,278289,278290,278308,278310,278315,278345,278346,278349,278366,278406,278509,278769,278770,278801,278802,278803,278804,278805,278808,278820,278822,278873,278874,278875,278923,278957,278962,278963,278969,278975,278976,278986,279024,279029,279071,279080,279115,279116,279479,279588,279653,279654,279656,279658,279667,279681,279682,279683,279684,279685,279691,279694,279715,279716,279760,279766,279767,279794,279823,279841,279844,279887,279931,279966,279975,279993,279994,280013,280015,280016,280017,280018,280020,280024,280187,280188,280191,280194,280242,280249,280251,280327,280330,280349,280363,280364,280383,280384,280385,281613,281639,281641,281693,281707,281726,281727,281797,281975,281976,282033,282034,282035,282037,282092,282708,282710,282712,282730,282731,282732,282733,282734,282735,282800,282807,282814,282842,282917,282918,282919,282922,282923,283042,283043,283049,283050,283052,283059,283270,283283,283305,283306,283307,283308,283353,283358,283359,283407,283408,283416,283453,283469,283478,283548,283680,283681,283682,283685,283820,283830,283834,283835,283865,283876,283877,283884,283885,283933,283934,283946,283964,284006,284014,284025,284029,284035,284036,284037,284038,284039,284040,284041,284042,284043,284044) 
elif year == ['2018']:
    #dirDQM="/afs/cern.ch/user/d/dwalter/cernBox/www/ZCounting/DQM-Offline-2018/"
    ByLsCSV="/afs/cern.ch/work/d/dwalter/CMSSW_9_2_8/src/ZCounting/Stuff/ByLs_2018_IsoMu24_hfoc18v5.csv"
           #"/eos/cms/store/group/comm_luminosity/ZCounting/brilcalcFile2018/briloutByLS_11_19_18.csv"
    #2018 A,B,C
    runlist = (317527,)
#    runlist = (315257,315259,315264,315265,315267,315270,315322,315339,315357,315361,315363,315366,315420,315488,315489,315490,315506,315510,315512,315543,315555,315556,315557,315640,315641,315642,315644,315645,315646,315647,315648,315689,315690,315702,315703,315704,315705,315713,315721,315741,315764,315770,315784,315785,315786,315790,315800,315801,315840,315973,315974,316058,316059,316060,316061,316062,316082,316110,316111,316113,316114,316153,316186,316187,316199,316200,316201,316202,316216,316217,316218,316219,316239,316240,316241,316271,316361,316362,316363,316377,316378,316379,316380,316455,316457,316469,316470,316472,316505,316569,316590,316613,316615,316666,316667,316700,316701,316702,316715,316716,316717,316718,316719,316720,316721,316722,316723,316758,316766,316876,316877,316879,316928,316985,316993,316994,316995,317080,317087,317089,317182,317212,317213,317279,317291,317292,317297,317319,317320,317338,317339,317340,317382,317383,317391,317392,317435,317438,317475,317478,317484,317488,317527,317591,317626,317640,317641,317648,317649,317650,317661,317663,317683,317696,318828,318872,318874,318876,318877,319077,319337,319347,319348,319349,319449,319450,319456,319459,319486,319503,319524,319526,319528,319579,319625,319639,319656,319657,319658,319659,319678,319687,319697,319698,319756,319840,319841,319847,319848,319849,319851,319853,319854,319908,319909,319910,319912,319913,319914,319915,319941,319942,319950,319991,319992,319993,320002,320006,320010,320011,320012,320023,320024,320025,320026,320038,320039,320040,320059,320060,320061,320062,320063,320064,320065)
    #2018 D
#    runlist = (320673,320674,320688,320712,320757,320804,320807,320809,320821,320822,320823,320824,320838,320840,320841,320853,320854,320855,320856,320857,320858,320859,320887,320888,320916,320917,320920,320933,320934,320936,320941,320980,320995,320996,321004,321005,321006,321007,321009,321010,321011,321012,321051,321055,321067,321068,321069,321119,321121,321122,321124,321126,321134,321138,321140,321149,321165,321166,321167,321177,321178,321218,321219,321221,321230,321231,321232,321262,321283,321294,321295,321296,321305,321311,321312,321313,321393,321396,321397,321414,321415,321431,321432,321433,321434,321436,321457,321461,321475,321710,321712,321730,321732,321735,321755,321758,321760,321773,321774,321775,321776,321777,321778,321780,321781,321815,321817,321818,321820,321831,321832,321833,321834,321879,321880,321887,321908,321909,321917,321919,321933,321960,321961,321973,321975,321988,321990,322013,322014,322022,322040,322057,322068,322079,322106,322113,322118,322179,322201,322204,322222,322252,322317,322319,322322,322324,322332,322348,322355,322356,322381,322407,322430,322431,322480,322492,322510,322599,322602,322603,322605,322617,322625,322633,323414,323423,323470,323471,323472,323473,323474,323475,323487,323488,323492,323493,323495,323524,323525,323526,323693,323696,323702,323725,323726,323727,323755,323775,323778,323790,323794,323841,323857,323940,323954,323976,323978,323980,323983,323997,324021,324022,324077,324201,324202,324205,324206,324207,324209,324237,324245,324293,324315,324318,324420,324729,324747,324764,324765,324769,324772,324785,324791,324835,324840,324841,324846,324897,324970,324980,324997,324998,324999,325000,325001,325022,325057,325097,325098,325099,325100,325101,325110,325117,325159,325168,325169,325170,325172)
    #not complete runs in 2018 D
  #  runlist = (324878,321813,321233)
else:
     print "no data for year "+str(year)

#runlist = (315257,315259)

cs_file = open("cs_tmp.sub", "w")

cs_file.write("executable  = runZCountingOnBatch.sh \n")
cs_file.write("output      = condor/output/$(ClusterId).$(ProcId).out \n")
cs_file.write("error       = condor/error/$(ClusterId).$(ProcId).err \n")
cs_file.write("log         = condor/log/$(ClusterId).$(ProcId).log \n")
cs_file.write("+JobFlavour =\"workday\" \n")
for run in runlist:
    cs_file.write("arguments  = {0} {1} {2} {3} {4} {5} {6}\n".format(str(run),
        dirDQM,
        ByLsCSV,
        dirMC,
        dirMCShape,
        dirCSV,
        dirEff
	))

    cs_file.write("queue\n")
cs_file.close()

os.system("condor_submit cs_tmp.sub")

#os.system("rm cs_tmp.sub")
